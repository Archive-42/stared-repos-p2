var ComboboxAutocomplete;(ComboboxAutocomplete=function(t,o,e){this.comboboxNode=t,this.buttonNode=o,this.listboxNode=e,this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!1,this.hasHover=!1,this.isNone=!1,this.isList=!1,this.isBoth=!1,this.allOptions=[],this.allOptionsUnchanged=[],this.option=null,this.firstOption=null,this.lastOption=null,this.filteredOptions=[],this.filter=""}).prototype.init=function(){var t=this.comboboxNode.getAttribute("aria-autocomplete");"string"==typeof t?(t=t.toLowerCase(),this.isNone="none"===t,this.isList="list"===t,this.isBoth="both"===t):this.isNone=!0,this.comboboxNode.addEventListener("keydown",this.handleComboboxKeyDown.bind(this)),this.comboboxNode.addEventListener("keyup",this.handleComboboxKeyUp.bind(this)),this.comboboxNode.addEventListener("input",this.handleComboboxInput.bind(this)),this.comboboxNode.addEventListener("click",this.handleComboboxClick.bind(this)),this.comboboxNode.addEventListener("focus",this.handleComboboxFocus.bind(this)),this.comboboxNode.addEventListener("blur",this.handleComboboxBlur.bind(this)),this.listboxNode.addEventListener("mouseover",this.handleListboxMouseover.bind(this)),this.listboxNode.addEventListener("mouseout",this.handleListboxMouseout.bind(this));for(var o=this.listboxNode.getElementsByTagName("LI"),e=0;e<o.length;e++){var i=o[e];this.allOptions.push(i),i.addEventListener("click",this.handleOptionClick.bind(this)),i.addEventListener("mouseover",this.handleOptionMouseover.bind(this)),i.addEventListener("mouseout",this.handleOptionMouseout.bind(this))}this.allOptionsUnchanged=this.allOptions,this.filterOptions();var s=this.comboboxNode.nextElementSibling;s&&"BUTTON"===s.tagName&&s.addEventListener("click",this.handleButtonClick.bind(this))},ComboboxAutocomplete.prototype.getLowercaseContent=function(t){return t.textContent.toLowerCase()},ComboboxAutocomplete.prototype.setActiveDescendant=function(t){t&&this.listboxHasVisualFocus?this.comboboxNode.setAttribute("aria-activedescendant",t.id):this.comboboxNode.setAttribute("aria-activedescendant","")},ComboboxAutocomplete.prototype.setValue=function(t,o){this.filter=t,this.comboboxNode.value=this.filter,this.comboboxNode.setSelectionRange(this.filter.length,this.filter.length),this.filterOptions()},ComboboxAutocomplete.prototype.setOption=function(t,o){"boolean"!=typeof o&&(o=!1),t&&(this.option=t,this.setCurrentOptionStyle(this.option),this.setActiveDescendant(this.option),this.isBoth&&(this.comboboxNode.value=this.option.textContent,o?this.comboboxNode.setSelectionRange(this.option.textContent.length,this.option.textContent.length):this.comboboxNode.setSelectionRange(this.filter.length,this.option.textContent.length)))},ComboboxAutocomplete.prototype.setVisualFocusCombobox=function(){this.listboxNode.classList.remove("focus"),this.comboboxNode.parentNode.classList.add("focus"),this.comboboxHasVisualFocus=!0,this.listboxHasVisualFocus=!1,this.setActiveDescendant(!1)},ComboboxAutocomplete.prototype.setVisualFocusListbox=function(){this.comboboxNode.parentNode.classList.remove("focus"),this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!0,this.listboxNode.classList.add("focus"),this.setActiveDescendant(this.option)},ComboboxAutocomplete.prototype.removeVisualFocusAll=function(){this.comboboxNode.parentNode.classList.remove("focus"),this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!1,this.listboxNode.classList.remove("focus"),this.option=null,this.setActiveDescendant(!1)},ComboboxAutocomplete.prototype.filterOptions=function(){this.isNone&&(this.filter="");var t=null,o=this.option,e=this.filter.toLowerCase();this.filteredOptions=[],this.listboxNode.innerHTML="";for(var i=0;i<this.allOptions.length;i++)t=this.allOptions[i],0!==e.length&&-1===this.getLowercaseContent(t).indexOf(e)||(this.filteredOptions.push(t),this.listboxNode.appendChild(t));var s=this.filteredOptions.length;return 0<s?(this.firstOption=this.filteredOptions[0],this.lastOption=this.filteredOptions[s-1],t=o&&0<=this.filteredOptions.indexOf(o)?o:this.firstOption):(t=this.firstOption=null,this.lastOption=null),t},ComboboxAutocomplete.prototype.setCurrentOptionStyle=function(t){for(var o=0;o<this.filteredOptions.length;o++){var e=this.filteredOptions[o];e===t?(e.setAttribute("aria-selected","true"),this.listboxNode.scrollTop+this.listboxNode.offsetHeight<e.offsetTop+e.offsetHeight?this.listboxNode.scrollTop=e.offsetTop+e.offsetHeight-this.listboxNode.offsetHeight:this.listboxNode.scrollTop>e.offsetTop+2&&(this.listboxNode.scrollTop=e.offsetTop)):e.removeAttribute("aria-selected")}},ComboboxAutocomplete.prototype.getPreviousOption=function(t){if(t===this.firstOption)return this.lastOption;var o=this.filteredOptions.indexOf(t);return this.filteredOptions[o-1]},ComboboxAutocomplete.prototype.getNextOption=function(t){if(t===this.lastOption)return this.firstOption;var o=this.filteredOptions.indexOf(t);return this.filteredOptions[o+1]},ComboboxAutocomplete.prototype.doesOptionHaveFocus=function(){return""!==this.combobocNode.getAttribute("aria-activedescendant")},ComboboxAutocomplete.prototype.isOpen=function(){return this.listboxNode.classList.contains("combo-box__list--visible")},ComboboxAutocomplete.prototype.isClosed=function(){return!this.listboxNode.classList.contains("combo-box__list--visible")},ComboboxAutocomplete.prototype.hasOptions=function(){return this.filteredOptions.length},ComboboxAutocomplete.prototype.open=function(){this.listboxNode.classList.add("combo-box__list--visible"),this.comboboxNode.setAttribute("aria-expanded","true"),this.buttonNode.setAttribute("aria-expanded","true")},ComboboxAutocomplete.prototype.close=function(t){"boolean"!=typeof t&&(t=!1),!t&&(this.comboboxHasVisualFocus||this.listboxHasVisualFocus||this.hasHover)||(this.setCurrentOptionStyle(!1),this.listboxNode.classList.remove("combo-box__list--visible"),this.comboboxNode.setAttribute("aria-expanded","false"),this.buttonNode.setAttribute("aria-expanded","false"),this.setActiveDescendant(!1))},ComboboxAutocomplete.prototype.dispatchInputEvent=function(){this.comboboxNode.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))},ComboboxAutocomplete.prototype.handleComboboxKeyDown=function(t){var o=!1,e=t.altKey;if(!t.ctrlKey&&!t.shiftKey){switch(t.keyCode){case 13:if(this.listboxHasVisualFocus&&this.setValue(this.option.textContent,this.option.id),this.close(!0),this.setVisualFocusCombobox(),o=!0,this.dispatchInputEvent(),!this.option){this.listboxNode.children.length&&(location.href=this.listboxNode.children[0].dataset.comboUrl);break}location.href=this.option.dataset.comboUrl;break;case 40:0<this.filteredOptions.length&&(e?this.open():(this.open(),this.listboxHasVisualFocus||this.isBoth&&1<this.filteredOptions.length?this.setOption(this.getNextOption(this.option),!0):this.setOption(this.firstOption,!0),this.setVisualFocusListbox())),o=!0;break;case 38:this.hasOptions()&&(this.listboxHasVisualFocus?this.setOption(this.getPreviousOption(this.option),!0):(this.open(),e||(this.setOption(this.lastOption,!0),this.setVisualFocusListbox()))),o=!0;break;case 27:this.isOpen()?(this.close(!0),this.filter=this.comboboxNode.value,this.filterOptions(),this.setVisualFocusCombobox()):(this.setValue("",""),this.comboboxNode.value=""),o=!(this.option=null);break;case 9:this.close(!0),this.listboxHasVisualFocus&&this.option&&this.setValue(this.option.textContent,this.option.id);break;case 36:this.comboboxNode.setSelectionRange(0,0),o=!0;break;case 35:var i=this.comboboxNode.value.length;this.comboboxNode.setSelectionRange(i,i),o=!0}o&&(t.stopPropagation(),t.preventDefault())}},ComboboxAutocomplete.prototype.isPrintableCharacter=function(t){return t&&1===t.length&&t.match(/\S/)},ComboboxAutocomplete.prototype.handleComboboxInput=function(t){var o=t.data,e=!1,i=null;this.isPrintableCharacter(o)&&(this.filter+=o),this.comboboxNode.value.length<this.filter.length&&(this.filter=this.comboboxNode.value,this.option=null,this.filterOptions()),-1===[27,8,35,36,37,39].indexOf(t.keyCode)&&(this.isPrintableCharacter(o)&&(this.setVisualFocusCombobox(),this.setCurrentOptionStyle(!1),e=!0,this.isList||this.isBoth?(i=this.filterOptions())?(this.isClosed()&&this.comboboxNode.value.length&&this.open(),0===this.getLowercaseContent(i).indexOf(this.comboboxNode.value.toLowerCase())?(this.option=i,(this.isBoth||this.listboxHasVisualFocus)&&(this.setCurrentOptionStyle(i),this.isBoth&&this.setOption(i))):(this.option=null,this.setCurrentOptionStyle(!1))):(this.close(),this.option=null,this.setActiveDescendant(!1)):this.comboboxNode.value.length&&this.open()),e&&(t.stopPropagation(),t.preventDefault()))},ComboboxAutocomplete.prototype.handleComboboxKeyUp=function(t){var o=!1;if(27!==t.keyCode){switch(t.keyCode){case 8:this.setVisualFocusCombobox(),this.setCurrentOptionStyle(!1),this.filter=this.comboboxNode.value,this.option=null,this.filterOptions(),o=!0;break;case 35:case 36:case 37:case 39:this.isBoth?this.filter=this.comboboxNode.value:(this.option=null,this.setCurrentOptionStyle(!1)),this.setVisualFocusCombobox(),o=!0}o&&(t.stopPropagation(),t.preventDefault())}},ComboboxAutocomplete.prototype.handleComboboxClick=function(t){this.isOpen()?this.close(!0):this.open()},ComboboxAutocomplete.prototype.handleComboboxFocus=function(t){this.filter=this.comboboxNode.value,this.filterOptions(),this.setVisualFocusCombobox(),this.option=null,this.setCurrentOptionStyle(null)},ComboboxAutocomplete.prototype.handleComboboxBlur=function(t){this.comboboxHasVisualFocus=!1,this.setCurrentOptionStyle(null),this.removeVisualFocusAll(),setTimeout(this.close.bind(this,!1),300)},ComboboxAutocomplete.prototype.handleButtonClick=function(t){this.isOpen()?this.close(!0):this.open(),this.comboboxNode.focus(),this.setVisualFocusCombobox()},ComboboxAutocomplete.prototype.handleListboxMouseover=function(t){this.hasHover=!0},ComboboxAutocomplete.prototype.handleListboxMouseout=function(t){this.hasHover=!1,setTimeout(this.close.bind(this,!1),300)},ComboboxAutocomplete.prototype.handleOptionClick=function(t){this.comboboxNode.value=t.target.textContent,t.target.dataset.comboUrl&&(location.href=t.target.dataset.comboUrl),this.close(!0),this.dispatchInputEvent()},ComboboxAutocomplete.prototype.handleOptionMouseover=function(t){this.hasHover=!0,this.open()},ComboboxAutocomplete.prototype.handleOptionMouseout=function(t){this.hasHover=!1,setTimeout(this.close.bind(this,!1),300)};for(var comboboxes=document.querySelectorAll(".js-combo-box"),i=0;i<comboboxes.length;i++){var cba=new ComboboxAutocomplete(comboboxNode=(combobox=comboboxes[i]).querySelector("input"),buttonNode=combobox.querySelector("button"),listboxNode=combobox.querySelector('[role="listbox"]'));comboboxNode.value="",cba.init(),document.documentElement.classList.remove("no-js"),document.documentElement.classList.add("js")}(ComboboxAutocomplete=function(t,o,e){this.comboboxNode=t,this.buttonNode=o,this.listboxNode=e,this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!1,this.hasHover=!1,this.isNone=!1,this.isList=!1,this.isBoth=!1,this.allOptions=[],this.allOptionsUnchanged=[],this.option=null,this.firstOption=null,this.lastOption=null,this.filteredOptions=[],this.filter=""}).prototype.init=function(){var t=this.comboboxNode.getAttribute("aria-autocomplete");"string"==typeof t?(t=t.toLowerCase(),this.isNone="none"===t,this.isList="list"===t,this.isBoth="both"===t):this.isNone=!0,this.comboboxNode.addEventListener("keydown",this.handleComboboxKeyDown.bind(this)),this.comboboxNode.addEventListener("keyup",this.handleComboboxKeyUp.bind(this)),this.comboboxNode.addEventListener("input",this.handleComboboxInput.bind(this)),this.comboboxNode.addEventListener("click",this.handleComboboxClick.bind(this)),this.comboboxNode.addEventListener("focus",this.handleComboboxFocus.bind(this)),this.comboboxNode.addEventListener("blur",this.handleComboboxBlur.bind(this)),this.listboxNode.addEventListener("mouseover",this.handleListboxMouseover.bind(this)),this.listboxNode.addEventListener("mouseout",this.handleListboxMouseout.bind(this));for(var o=this.listboxNode.getElementsByTagName("LI"),e=0;e<o.length;e++){var i=o[e];this.allOptions.push(i),i.addEventListener("click",this.handleOptionClick.bind(this)),i.addEventListener("mouseover",this.handleOptionMouseover.bind(this)),i.addEventListener("mouseout",this.handleOptionMouseout.bind(this))}this.allOptionsUnchanged=this.allOptions,this.filterOptions();var s=this.comboboxNode.nextElementSibling;s&&"BUTTON"===s.tagName&&s.addEventListener("click",this.handleButtonClick.bind(this))},ComboboxAutocomplete.prototype.getLowercaseContent=function(t){return t.textContent.toLowerCase()},ComboboxAutocomplete.prototype.setActiveDescendant=function(t){t&&this.listboxHasVisualFocus?this.comboboxNode.setAttribute("aria-activedescendant",t.id):this.comboboxNode.setAttribute("aria-activedescendant","")},ComboboxAutocomplete.prototype.setValue=function(t,o){this.filter=t,this.comboboxNode.value=this.filter,this.comboboxNode.setSelectionRange(this.filter.length,this.filter.length),this.filterOptions()},ComboboxAutocomplete.prototype.setOption=function(t,o){"boolean"!=typeof o&&(o=!1),t&&(this.option=t,this.setCurrentOptionStyle(this.option),this.setActiveDescendant(this.option),this.isBoth&&(this.comboboxNode.value=this.option.textContent,o?this.comboboxNode.setSelectionRange(this.option.textContent.length,this.option.textContent.length):this.comboboxNode.setSelectionRange(this.filter.length,this.option.textContent.length)))},ComboboxAutocomplete.prototype.setVisualFocusCombobox=function(){this.listboxNode.classList.remove("focus"),this.comboboxNode.parentNode.classList.add("focus"),this.comboboxHasVisualFocus=!0,this.listboxHasVisualFocus=!1,this.setActiveDescendant(!1)},ComboboxAutocomplete.prototype.setVisualFocusListbox=function(){this.comboboxNode.parentNode.classList.remove("focus"),this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!0,this.listboxNode.classList.add("focus"),this.setActiveDescendant(this.option)},ComboboxAutocomplete.prototype.removeVisualFocusAll=function(){this.comboboxNode.parentNode.classList.remove("focus"),this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!1,this.listboxNode.classList.remove("focus"),this.option=null,this.setActiveDescendant(!1)},ComboboxAutocomplete.prototype.filterOptions=function(){this.isNone&&(this.filter="");var t=null,o=this.option,e=this.filter.toLowerCase();this.filteredOptions=[],this.listboxNode.innerHTML="";for(var i=0;i<this.allOptions.length;i++)t=this.allOptions[i],0!==e.length&&-1===this.getLowercaseContent(t).indexOf(e)||(this.filteredOptions.push(t),this.listboxNode.appendChild(t));var s=this.filteredOptions.length;return 0<s?(this.firstOption=this.filteredOptions[0],this.lastOption=this.filteredOptions[s-1],t=o&&0<=this.filteredOptions.indexOf(o)?o:this.firstOption):(t=this.firstOption=null,this.lastOption=null),t},ComboboxAutocomplete.prototype.setCurrentOptionStyle=function(t){for(var o=0;o<this.filteredOptions.length;o++){var e=this.filteredOptions[o];e===t?(e.setAttribute("aria-selected","true"),this.listboxNode.scrollTop+this.listboxNode.offsetHeight<e.offsetTop+e.offsetHeight?this.listboxNode.scrollTop=e.offsetTop+e.offsetHeight-this.listboxNode.offsetHeight:this.listboxNode.scrollTop>e.offsetTop+2&&(this.listboxNode.scrollTop=e.offsetTop)):e.removeAttribute("aria-selected")}},ComboboxAutocomplete.prototype.getPreviousOption=function(t){if(t===this.firstOption)return this.lastOption;var o=this.filteredOptions.indexOf(t);return this.filteredOptions[o-1]},ComboboxAutocomplete.prototype.getNextOption=function(t){if(t===this.lastOption)return this.firstOption;var o=this.filteredOptions.indexOf(t);return this.filteredOptions[o+1]},ComboboxAutocomplete.prototype.doesOptionHaveFocus=function(){return""!==this.combobocNode.getAttribute("aria-activedescendant")},ComboboxAutocomplete.prototype.isOpen=function(){return this.listboxNode.classList.contains("combo-box__list--visible")},ComboboxAutocomplete.prototype.isClosed=function(){return!this.listboxNode.classList.contains("combo-box__list--visible")},ComboboxAutocomplete.prototype.hasOptions=function(){return this.filteredOptions.length},ComboboxAutocomplete.prototype.open=function(){this.listboxNode.classList.add("combo-box__list--visible"),this.comboboxNode.setAttribute("aria-expanded","true"),this.buttonNode.setAttribute("aria-expanded","true")},ComboboxAutocomplete.prototype.close=function(t){"boolean"!=typeof t&&(t=!1),!t&&(this.comboboxHasVisualFocus||this.listboxHasVisualFocus||this.hasHover)||(this.setCurrentOptionStyle(!1),this.listboxNode.classList.remove("combo-box__list--visible"),this.comboboxNode.setAttribute("aria-expanded","false"),this.buttonNode.setAttribute("aria-expanded","false"),this.setActiveDescendant(!1))},ComboboxAutocomplete.prototype.dispatchInputEvent=function(){this.comboboxNode.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))},ComboboxAutocomplete.prototype.handleComboboxKeyDown=function(t){var o=!1,e=t.altKey;if(!t.ctrlKey&&!t.shiftKey){switch(t.keyCode){case 13:if(this.listboxHasVisualFocus&&this.setValue(this.option.textContent,this.option.id),this.close(!0),this.setVisualFocusCombobox(),o=!0,this.dispatchInputEvent(),!this.option){this.listboxNode.children.length&&(location.href=this.listboxNode.children[0].dataset.comboUrl);break}location.href=this.option.dataset.comboUrl;break;case 40:0<this.filteredOptions.length&&(e?this.open():(this.open(),this.listboxHasVisualFocus||this.isBoth&&1<this.filteredOptions.length?this.setOption(this.getNextOption(this.option),!0):this.setOption(this.firstOption,!0),this.setVisualFocusListbox())),o=!0;break;case 38:this.hasOptions()&&(this.listboxHasVisualFocus?this.setOption(this.getPreviousOption(this.option),!0):(this.open(),e||(this.setOption(this.lastOption,!0),this.setVisualFocusListbox()))),o=!0;break;case 27:this.isOpen()?(this.close(!0),this.filter=this.comboboxNode.value,this.filterOptions(),this.setVisualFocusCombobox()):(this.setValue("",""),this.comboboxNode.value=""),o=!(this.option=null);break;case 9:this.close(!0),this.listboxHasVisualFocus&&this.option&&this.setValue(this.option.textContent,this.option.id);break;case 36:this.comboboxNode.setSelectionRange(0,0),o=!0;break;case 35:var i=this.comboboxNode.value.length;this.comboboxNode.setSelectionRange(i,i),o=!0}o&&(t.stopPropagation(),t.preventDefault())}},ComboboxAutocomplete.prototype.isPrintableCharacter=function(t){return t&&1===t.length&&t.match(/\S/)},ComboboxAutocomplete.prototype.handleComboboxInput=function(t){var o=t.data,e=!1,i=null;this.isPrintableCharacter(o)&&(this.filter+=o),this.comboboxNode.value.length<this.filter.length&&(this.filter=this.comboboxNode.value,this.option=null,this.filterOptions()),-1===[27,8,35,36,37,39].indexOf(t.keyCode)&&(this.isPrintableCharacter(o)&&(this.setVisualFocusCombobox(),this.setCurrentOptionStyle(!1),e=!0,this.isList||this.isBoth?(i=this.filterOptions())?(this.isClosed()&&this.comboboxNode.value.length&&this.open(),0===this.getLowercaseContent(i).indexOf(this.comboboxNode.value.toLowerCase())?(this.option=i,(this.isBoth||this.listboxHasVisualFocus)&&(this.setCurrentOptionStyle(i),this.isBoth&&this.setOption(i))):(this.option=null,this.setCurrentOptionStyle(!1))):(this.close(),this.option=null,this.setActiveDescendant(!1)):this.comboboxNode.value.length&&this.open()),e&&(t.stopPropagation(),t.preventDefault()))},ComboboxAutocomplete.prototype.handleComboboxKeyUp=function(t){var o=!1;if(27!==t.keyCode){switch(t.keyCode){case 8:this.setVisualFocusCombobox(),this.setCurrentOptionStyle(!1),this.filter=this.comboboxNode.value,this.option=null,this.filterOptions(),o=!0;break;case 35:case 36:case 37:case 39:this.isBoth?this.filter=this.comboboxNode.value:(this.option=null,this.setCurrentOptionStyle(!1)),this.setVisualFocusCombobox(),o=!0}o&&(t.stopPropagation(),t.preventDefault())}},ComboboxAutocomplete.prototype.handleComboboxClick=function(t){this.isOpen()?this.close(!0):this.open()},ComboboxAutocomplete.prototype.handleComboboxFocus=function(t){this.filter=this.comboboxNode.value,this.filterOptions(),this.setVisualFocusCombobox(),this.option=null,this.setCurrentOptionStyle(null)},ComboboxAutocomplete.prototype.handleComboboxBlur=function(t){this.comboboxHasVisualFocus=!1,this.setCurrentOptionStyle(null),this.removeVisualFocusAll(),setTimeout(this.close.bind(this,!1),300)},ComboboxAutocomplete.prototype.handleButtonClick=function(t){this.isOpen()?this.close(!0):this.open(),this.comboboxNode.focus(),this.setVisualFocusCombobox()},ComboboxAutocomplete.prototype.handleListboxMouseover=function(t){this.hasHover=!0},ComboboxAutocomplete.prototype.handleListboxMouseout=function(t){this.hasHover=!1,setTimeout(this.close.bind(this,!1),300)},ComboboxAutocomplete.prototype.handleOptionClick=function(t){this.comboboxNode.value=t.target.textContent,t.target.dataset.comboUrl&&(location.href=t.target.dataset.comboUrl),this.close(!0),this.dispatchInputEvent()},ComboboxAutocomplete.prototype.handleOptionMouseover=function(t){this.hasHover=!0,this.open()},ComboboxAutocomplete.prototype.handleOptionMouseout=function(t){this.hasHover=!1,setTimeout(this.close.bind(this,!1),300)};for(comboboxes=document.querySelectorAll(".js-combo-box"),i=0;i<comboboxes.length;i++){var combobox,comboboxNode,buttonNode,listboxNode;cba=new ComboboxAutocomplete(comboboxNode=(combobox=comboboxes[i]).querySelector("input"),buttonNode=combobox.querySelector("button"),listboxNode=combobox.querySelector('[role="listbox"]'));comboboxNode.value="",cba.init(),document.documentElement.classList.remove("no-js"),document.documentElement.classList.add("js")}
var ComboboxAutocomplete=function(t,o,e){this.comboboxNode=t,this.buttonNode=o,this.listboxNode=e,this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!1,this.hasHover=!1,this.isNone=!1,this.isList=!1,this.isBoth=!1,this.allOptions=[],this.allOptionsUnchanged=[],this.option=null,this.firstOption=null,this.lastOption=null,this.filteredOptions=[],this.filter=""};ComboboxAutocomplete.prototype.init=function(){var t=this.comboboxNode.getAttribute("aria-autocomplete");"string"==typeof t?(t=t.toLowerCase(),this.isNone="none"===t,this.isList="list"===t,this.isBoth="both"===t):this.isNone=!0,this.comboboxNode.addEventListener("keydown",this.handleComboboxKeyDown.bind(this)),this.comboboxNode.addEventListener("keyup",this.handleComboboxKeyUp.bind(this)),this.comboboxNode.addEventListener("input",this.handleComboboxInput.bind(this)),this.comboboxNode.addEventListener("click",this.handleComboboxClick.bind(this)),this.comboboxNode.addEventListener("focus",this.handleComboboxFocus.bind(this)),this.comboboxNode.addEventListener("blur",this.handleComboboxBlur.bind(this)),this.listboxNode.addEventListener("mouseover",this.handleListboxMouseover.bind(this)),this.listboxNode.addEventListener("mouseout",this.handleListboxMouseout.bind(this));for(var o=this.listboxNode.getElementsByTagName("LI"),e=0;e<o.length;e++){var i=o[e];this.allOptions.push(i),i.addEventListener("click",this.handleOptionClick.bind(this)),i.addEventListener("mouseover",this.handleOptionMouseover.bind(this)),i.addEventListener("mouseout",this.handleOptionMouseout.bind(this))}this.allOptionsUnchanged=this.allOptions,this.filterOptions();var s=this.comboboxNode.nextElementSibling;s&&"BUTTON"===s.tagName&&s.addEventListener("click",this.handleButtonClick.bind(this))},ComboboxAutocomplete.prototype.getLowercaseContent=function(t){return t.textContent.toLowerCase()},ComboboxAutocomplete.prototype.setActiveDescendant=function(t){t&&this.listboxHasVisualFocus?this.comboboxNode.setAttribute("aria-activedescendant",t.id):this.comboboxNode.removeAttribute("aria-activedescendant")},ComboboxAutocomplete.prototype.setValue=function(t,o){this.filter=t,console.log(this.filter),this.comboboxNode.value=this.filter,this.comboboxNode.setSelectionRange(this.filter.length,this.filter.length),this.filterOptions()},ComboboxAutocomplete.prototype.setOption=function(t,o){"boolean"!=typeof o&&(o=!1),t&&(this.option=t,this.setCurrentOptionStyle(this.option),this.setActiveDescendant(this.option),this.isBoth&&(this.comboboxNode.value=this.option.textContent,o?this.comboboxNode.setSelectionRange(this.option.textContent.length,this.option.textContent.length):this.comboboxNode.setSelectionRange(this.filter.length,this.option.textContent.length)))},ComboboxAutocomplete.prototype.setVisualFocusCombobox=function(){this.listboxNode.classList.remove("focus"),this.comboboxNode.parentNode.classList.add("focus"),this.comboboxHasVisualFocus=!0,this.listboxHasVisualFocus=!1,this.setActiveDescendant(!1)},ComboboxAutocomplete.prototype.setVisualFocusListbox=function(){this.comboboxNode.parentNode.classList.remove("focus"),this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!0,this.listboxNode.classList.add("focus"),this.setActiveDescendant(this.option)},ComboboxAutocomplete.prototype.removeVisualFocusAll=function(){this.comboboxNode.parentNode.classList.remove("focus"),this.comboboxHasVisualFocus=!1,this.listboxHasVisualFocus=!1,this.listboxNode.classList.remove("focus"),this.option=null,this.setActiveDescendant(!1)},ComboboxAutocomplete.prototype.filterOptions=function(){this.isNone&&(this.filter="");var t=null,o=this.option,e=this.filter.toLowerCase();this.filteredOptions=[],this.listboxNode.innerHTML="";for(var i=0;i<this.allOptions.length;i++)t=this.allOptions[i],0!==e.length&&-1===this.getLowercaseContent(t).indexOf(e)||(this.filteredOptions.push(t),this.listboxNode.appendChild(t));var s=this.filteredOptions.length;return 0<s?(this.firstOption=this.filteredOptions[0],this.lastOption=this.filteredOptions[s-1],t=o&&0<=this.filteredOptions.indexOf(o)?o:this.firstOption):(t=this.firstOption=null,this.lastOption=null),t},ComboboxAutocomplete.prototype.setCurrentOptionStyle=function(t){for(var o=0;o<this.filteredOptions.length;o++){var e=this.filteredOptions[o];e===t?(e.setAttribute("aria-selected","true"),this.listboxNode.scrollTop+this.listboxNode.offsetHeight<e.offsetTop+e.offsetHeight?this.listboxNode.scrollTop=e.offsetTop+e.offsetHeight-this.listboxNode.offsetHeight:this.listboxNode.scrollTop>e.offsetTop+2&&(this.listboxNode.scrollTop=e.offsetTop)):e.removeAttribute("aria-selected")}},ComboboxAutocomplete.prototype.getPreviousOption=function(t){if(t===this.firstOption)return this.lastOption;var o=this.filteredOptions.indexOf(t);return this.filteredOptions[o-1]},ComboboxAutocomplete.prototype.getNextOption=function(t){if(t===this.lastOption)return this.firstOption;var o=this.filteredOptions.indexOf(t);return this.filteredOptions[o+1]},ComboboxAutocomplete.prototype.doesOptionHaveFocus=function(){return""!==this.combobocNode.getAttribute("aria-activedescendant")},ComboboxAutocomplete.prototype.isOpen=function(){return this.listboxNode.classList.contains("combo-box__list--visible")},ComboboxAutocomplete.prototype.isClosed=function(){return!this.listboxNode.classList.contains("combo-box__list--visible")},ComboboxAutocomplete.prototype.hasOptions=function(){return this.filteredOptions.length},ComboboxAutocomplete.prototype.open=function(){this.listboxNode.classList.add("combo-box__list--visible"),this.comboboxNode.setAttribute("aria-expanded","true"),this.buttonNode.setAttribute("aria-expanded","true")},ComboboxAutocomplete.prototype.close=function(t){"boolean"!=typeof t&&(t=!1),!t&&(this.comboboxHasVisualFocus||this.listboxHasVisualFocus||this.hasHover)||(this.setCurrentOptionStyle(!1),this.listboxNode.classList.remove("combo-box__list--visible"),this.comboboxNode.setAttribute("aria-expanded","false"),this.buttonNode.setAttribute("aria-expanded","false"),this.setActiveDescendant(!1))},ComboboxAutocomplete.prototype.dispatchInputEvent=function(){this.comboboxNode.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))},ComboboxAutocomplete.prototype.handleComboboxKeyDown=function(t){var o=!1,e=t.altKey;if(!t.ctrlKey&&!t.shiftKey){switch(t.keyCode){case 13:if(this.listboxHasVisualFocus&&this.setValue(this.option.textContent,this.option.id),this.close(!0),this.setVisualFocusCombobox(),o=!0,this.dispatchInputEvent(),!this.option){this.listboxNode.children.length&&(location.href=this.listboxNode.children[0].dataset.comboUrl);break}location.href=this.option.dataset.comboUrl;break;case 40:0<this.filteredOptions.length&&(e?this.open():(this.open(),this.listboxHasVisualFocus||this.isBoth&&1<this.filteredOptions.length?this.setOption(this.getNextOption(this.option),!0):this.setOption(this.firstOption,!0),this.setVisualFocusListbox())),o=!0;break;case 38:this.hasOptions()&&(this.listboxHasVisualFocus?this.setOption(this.getPreviousOption(this.option),!0):(this.open(),e||(this.setOption(this.lastOption,!0),this.setVisualFocusListbox()))),o=!0;break;case 27:this.isOpen()?(this.close(!0),this.filter=this.comboboxNode.value,this.filterOptions(),this.setVisualFocusCombobox()):(this.setValue("",""),this.comboboxNode.value=""),o=!(this.option=null);break;case 9:this.close(!0),this.listboxHasVisualFocus&&this.option&&this.setValue(this.option.textContent,this.option.id);break;case 36:this.comboboxNode.setSelectionRange(0,0),o=!0;break;case 35:var i=this.comboboxNode.value.length;this.comboboxNode.setSelectionRange(i,i),o=!0}o&&(t.stopPropagation(),t.preventDefault())}},ComboboxAutocomplete.prototype.isPrintableCharacter=function(t){return t&&1===t.length&&t.match(/\S/)},ComboboxAutocomplete.prototype.handleComboboxInput=function(t){var o=t.data,e=!1,i=null;this.isPrintableCharacter(o)&&(this.filter+=o),this.comboboxNode.value.length<this.filter.length&&(this.filter=this.comboboxNode.value,this.option=null,this.filterOptions());-1===[27,8,35,36,37,39].indexOf(t.keyCode)&&(this.isPrintableCharacter(o)&&(this.setVisualFocusCombobox(),this.setCurrentOptionStyle(!1),e=!0,this.isList||this.isBoth?(i=this.filterOptions())?(this.isClosed()&&this.comboboxNode.value.length&&this.open(),0===this.getLowercaseContent(i).indexOf(this.comboboxNode.value.toLowerCase())?(this.option=i,(this.isBoth||this.listboxHasVisualFocus)&&(this.setCurrentOptionStyle(i),this.isBoth&&this.setOption(i))):(this.option=null,this.setCurrentOptionStyle(!1))):(this.close(),this.option=null,this.setActiveDescendant(!1)):this.comboboxNode.value.length&&this.open()),e&&(t.stopPropagation(),t.preventDefault()))},ComboboxAutocomplete.prototype.handleComboboxKeyUp=function(t){var o=!1;if(27!==t.keyCode){switch(t.keyCode){case 8:this.setVisualFocusCombobox(),this.setCurrentOptionStyle(!1),this.filter=this.comboboxNode.value,this.option=null,this.filterOptions(),o=!0;break;case 35:case 36:case 37:case 39:this.isBoth?this.filter=this.comboboxNode.value:(this.option=null,this.setCurrentOptionStyle(!1)),this.setVisualFocusCombobox(),o=!0}o&&(t.stopPropagation(),t.preventDefault())}},ComboboxAutocomplete.prototype.handleComboboxClick=function(t){console.log(this.isOpen()),this.isOpen()?this.close(!0):this.open()},ComboboxAutocomplete.prototype.handleComboboxFocus=function(t){this.filter=this.comboboxNode.value,this.filterOptions(),this.setVisualFocusCombobox(),this.option=null,this.setCurrentOptionStyle(null)},ComboboxAutocomplete.prototype.handleComboboxBlur=function(t){this.comboboxHasVisualFocus=!1,this.setCurrentOptionStyle(null),this.removeVisualFocusAll(),setTimeout(this.close.bind(this,!1),300)},ComboboxAutocomplete.prototype.handleButtonClick=function(t){this.isOpen()?this.close(!0):this.open(),this.comboboxNode.focus(),this.setVisualFocusCombobox()},ComboboxAutocomplete.prototype.handleListboxMouseover=function(t){this.hasHover=!0},ComboboxAutocomplete.prototype.handleListboxMouseout=function(t){this.hasHover=!1,setTimeout(this.close.bind(this,!1),300)},ComboboxAutocomplete.prototype.handleOptionClick=function(t){this.comboboxNode.value=t.target.textContent,t.target.dataset.comboUrl&&(location.href=t.target.dataset.comboUrl),this.close(!0),this.dispatchInputEvent()},ComboboxAutocomplete.prototype.handleOptionMouseover=function(t){this.hasHover=!0,this.open()},ComboboxAutocomplete.prototype.handleOptionMouseout=function(t){this.hasHover=!1,setTimeout(this.close.bind(this,!1),300)};for(var comboboxes=document.querySelectorAll(".js-combo-box"),i=0;i<comboboxes.length;i++){var combobox=comboboxes[i],comboboxNode=combobox.querySelector("input"),buttonNode=combobox.querySelector("button"),listboxNode=combobox.querySelector('[role="listbox"]'),cba=new ComboboxAutocomplete(comboboxNode,buttonNode,listboxNode);comboboxNode.value="",cba.init(),console.log("init"),document.documentElement.classList.remove("no-js"),document.documentElement.classList.add("js")}